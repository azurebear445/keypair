# CLOUD-XXXX
## Create foundational Azure SSH Public Key module with base resource

**Story Points:** 1
**Type:** Story

---

### Description

Create the base Azure SSH Public Key Terraform module as part of the AWS-to-Azure migration effort. This module is the Azure equivalent of the existing `terraform-aws-instance_key_pair` module.

In AWS, the module creates an EC2 key pair with a TLS-generated private key. The Azure equivalent will create an `azurerm_ssh_public_key` resource with the same TLS key generation approach.

This story covers base resource creation only. Additional features and testing will follow in subsequent stories.

**AWS Reference Module:** `terraform-aws-instance_key_pair`

---

### Acceptance Criteria

- [ ] Module creates TLS private key (RSA, matching AWS default)
- [ ] Module creates `azurerm_ssh_public_key` resource
- [ ] Private key output marked as sensitive
- [ ] Tag processing logic follows approved module patterns (NSG, Storage Account)
- [ ] Variables include namespace, environment, location, resource_group_name
- [ ] Location validation restricts to approved Azure regions
- [ ] Example configuration provided in `examples/default/`
- [ ] README with module description and sensitive output instructions
- [ ] `terraform validate` passes
- [ ] Module file structure matches existing Azure module conventions

---

### Definition of Done

- [ ] Module files created: main.tf, variables.tf, outputs.tf, tags.tf, versions.tf
- [ ] Example usage provided
- [ ] README created
- [ ] Code reviewed and approved
- [ ] Merged to main branch

---

### Out of Scope (Future Stories)

- Key rotation or expiry logic
- Integration with Azure Key Vault
- Conditional key algorithm selection (e.g., ECDSA)
- Sandbox testing and publishing

---

### Dependencies

- Access to Azure module repository
- Approved tag structure from existing modules

---

### AWS to Azure Mapping

| AWS | Azure |
|-----|-------|
| `tls_private_key` | `tls_private_key` (same) |
| `aws_key_pair` | `azurerm_ssh_public_key` |
| Key pair attached to EC2 | SSH key referenced by VM |
| VPC-scoped | Resource Group + Location scoped |



Summary:
Created example configurations and documentation for team consumption.

Changes:
- Renamed examples/default/ to examples/basic/
- Created examples/advanced/ with lifecycle and custom tags
- Updated README.md with feature comparison table (AWS vs Azure)
- Added complete variable documentation
- Added usage examples, outputs, limitations, and troubleshooting sections

Testing:
- terraform validate ✅
- terraform plan ✅
- Basic example deploys successfully in sandbox



Raised MR for base Azure SSH Public Key module.
Changes:

Created module with TLS private key generation (RSA 4096)
Created azurerm_ssh_public_key resource
Follows approved NSG module patterns (tags, variables, naming, structure)
Sensitive output for private_key_pem
Example in examples/default/

Validation:

terraform fmt ✅
terraform init ✅
terraform validate ✅
terraform apply ✅




Add existing key import, algorithm options, and lifecycle configuration to SSH Public Key module
Story Points: 2

Description
Enhance the Azure SSH Public Key module with additional flexibility:

Allow users to provide an existing public key instead of generating a new one
Support ECDSA algorithm as an alternative to RSA
Add lifecycle configuration options for enterprise key management


Acceptance Criteria

Optional public_key variable added — if provided, uses existing key instead of generating new one
Algorithm variable added with RSA (default) and ECDSA options
ECDSA curve options available (P256, P384, P521)
Lifecycle configuration variable added (create_before_destroy, prevent_destroy)
New example folder examples/existing_key demonstrating bring-your-own-key usage
README updated with new features
terraform fmt passes
terraform validate passes
terraform plan passes
terraform apply successful in sandbox


Definition of Done

Variables added with proper validations
Conditional logic implemented for key generation vs import
examples/default updated to test default behavior
examples/existing_key created to test bring-your-own-key feature
README updated
Code reviewed and approved
Merged to main branch



